# Блажко Иван ИТ-8 Лабораторная работа №5
## Разработать консольное приложение с дружественным интерфейсом с возможностью выбора заданий. Приложение должно выполнять следующие функции:
1. Чтение базы данных из excel файла.
2. Просмотр базы данных.
3. Удаление элементов (по ключу).
4. Добавление элементов.
5. Реализация 4 запросов (формулировки запросов придумать самостоятельно и отразить в
отчёте, можно использовать запрос, данный в примере):
1. 1 запрос с обращением к одной таблице
2. 1 запрос с обращением к двум таблицам
3. 2 запроса с обращением к трем таблицам
2 запроса должны возвращать перечень, 2 запроса одно значение.
6. Сохранение изменений в excel файле.

### 1. Чтение базы данных из Excel файла
1. Запуск программы
2. Проверка наличия файла Excel в директории
3. Если файл существует:
   - Открытие файла для чтения
   - Поиск листов "Автомобили", "Водители", "Рейсы"
   - Построчное чтение данных с пропуском заголовков
   - Для каждой строки создание объекта соответствующего класса
   - Добавление объектов в списки
 4. Если файл не найден:
   - Вывод сообщения об ошибке
   - Завершение программы

### 2. Просмотр базы данных
1. Выбор пользователем типа данных для просмотра
2. Проверка наличия записей в выбранном списке
3. Если записи есть:
   - Циклический проход по всем элементам списка
   - Вывод информации каждого элемента через ToString()
   - Отображение общего количества записей
4. Если записей нет:
   - Вывод сообщения о пустом списке

### 3. Удаление элементов
1. Выбор пользователем типа данных для удаления
2. Запрос ID элемента для удаления
3. Проверка корректности введенного ID (целое положительное число)
4. Поиск элемента с указанным ID в соответствующем списке
5. Если элемент найден:
   - Удаление элемента из списка
   - Автоматическое сохранение изменений в файл
   - Вывод сообщения об успешном удалении
6. Если элемент не найден:
   - Вывод сообщения об ошибке
<img width="730" height="307" alt="image" src="https://github.com/user-attachments/assets/2f3a3f4e-ce9a-4184-bffb-6e24fca4c970" />
<img width="698" height="245" alt="image" src="https://github.com/user-attachments/assets/fe0fa386-0503-4eb8-b84b-1bbba10bd3bf" />



### 4. Добавление элементов
1. Выбор пользователем типа данных для добавления
2. Последовательный ввод характеристик элемента:
   - Ввод текстовых полей с проверкой на пустоту
   - Ввод числовых полей с проверкой на корректность формата
   - Ввод дат с проверкой формата и логики
3. Проверка введенных данных на соответствие допустимым диапазонам
4. Генерация нового уникального ID (максимальный ID в списке + 1)
5. Создание нового объекта с введенными данными
6. Добавление объекта в соответствующий список
7. Автоматическое сохранение изменений в файл
8. Вывод сообщения об успешном добавлении с указанием нового ID

### 5. Выполнение запросов
Запрос 1: Количество автомобилей одной марки имеющихся в парке после определенного года
1. Запрос критериев отбора у пользователя
2. Создание пустого списка для результатов
3. Циклический проход по всем элементам таблицы
4. Проверка каждого элемента на соответствие критериям
5. Добавление подходящих элементов в список результатов
6. Вывод всех найденных элементов
7. Отображение общего количества результатов

Запрос 2: Стоимость рейсов для водителя
1. Запрос критериев поиска у пользователя
2. Поиск в первой таблице элемента по заданным критериям
3. Если элемент найден:
   - Циклический проход по второй таблице
   - Отбор связанных записей по общему полю
   - Вычисление итогового значения
   - Вывод результата
4. Если элемент не найден:
   - Вывод сообщения об ошибке

Запрос 3: Количество рейсов превышающих заданное расстояние
1. Запрос критериев отбора у пользователя
2. Создание пустого списка для результатов
3. Циклический проход по основной таблице
4. Для каждой записи, удовлетворяющей критериям:
   - Поиск связанных данных в двух других таблицах
   - Формирование объединенной информации
   - Добавление в список результатов
5. Вывод всех найденных записей с полной информацией
6. Отображение общего количества результатов

Запрос 4: Средний стаж водителей определенной марки машин
1. Запрос критериев поиска у пользователя
2. Создание списка уникальных идентификаторов
3. Циклический проход по первой таблице
4. Для каждого элемента, соответствующего критериям:
   - Поиск связанных записей во второй таблице
   - Добавление уникальных идентификаторов из третьей таблицы
5. Вычисление итогового значения по найденным записям
6. Вывод результата
7. Если данные не найдены - вывод сообщения об ошибке
